<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy New Year Satu üíó Punch</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Mitr:wght@300;500&family=Caveat:wght@700&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #0a0a0a;
            overflow: hidden;
            font-family: 'Mitr', sans-serif;
            color: white;
            user-select: none;
            touch-action: manipulation;
        }

        canvas {
            display: block;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1;
        }

        .stage {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
            transition: opacity 1s ease-in-out, transform 1s ease-in-out;
        }

        .hidden {
            opacity: 0;
            pointer-events: none;
            visibility: hidden;
            transform: scale(0.9);
        }

        #stage-init-envelope {
            background: radial-gradient(circle, #1a1a1a 0%, #0a0a0a 100%);
            z-index: 100;
        }

        .envelope-btn {
            font-size: clamp(5rem, 20vw, 7rem);
            cursor: pointer;
            filter: drop-shadow(0 0 20px rgba(255, 77, 109, 0.6));
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .couple-name {
            font-family: 'Caveat', cursive;
            font-size: clamp(3.5rem, 15vw, 7rem);
            background: linear-gradient(to bottom, #ff9a9e 0%, #fecfef 50%, #ff9a9e 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 0 20px rgba(255, 154, 158, 0.9));
            text-align: center;
            animation: floatingName 3s infinite ease-in-out;
            padding: 0 10px;
        }

        @keyframes floatingName {
            0%, 100% { transform: translateY(0) rotate(-1deg); }
            50% { transform: translateY(-15px) rotate(1deg); }
        }

        #timer-display {
            display: flex;
            gap: 10px;
            text-align: center;
            transition: all 1.5s cubic-bezier(0.4, 0, 0.2, 1);
            flex-wrap: wrap;
            justify-content: center;
            max-width: 90vw;
        }

        .timer-box {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 15px;
            border: 1px solid rgba(255, 154, 158, 0.3);
            min-width: 80px;
            box-shadow: 0 0 15px rgba(255, 154, 158, 0.1);
            backdrop-filter: blur(5px);
            animation: timerFloat 4s infinite ease-in-out;
        }

        @keyframes timerFloat {
            0%, 100% { transform: translateY(0); box-shadow: 0 0 15px rgba(255, 154, 158, 0.1); }
            50% { transform: translateY(-10px); box-shadow: 0 0 25px rgba(255, 154, 158, 0.3); }
        }

        .timer-val { 
            font-size: clamp(1.8rem, 8vw, 3rem); 
            font-weight: bold; 
            color: white; 
            display: block;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .timer-label { font-size: 0.8rem; color: #fecfef; }

        #timer-message {
            margin-top: 30px;
            font-size: 1.2rem;
            color: #fecfef;
            text-align: center;
            min-height: 2em;
            transition: opacity 1s ease-in-out;
            max-width: 80vw;
            text-shadow: 0 0 10px rgba(255, 154, 158, 0.5);
        }

        .shrunk-timer {
            transform: scale(0.45) translateY(-100vh);
            top: 60px !important;
            left: 50% !important;
            position: fixed !important;
            gap: 5px !important;
            width: auto !important;
        }

        .shrunk-timer .timer-box {
            padding: 8px !important;
            background: rgba(0,0,0,0.6) !important;
            animation: none;
            min-width: 60px !important;
        }

        #plane-container {
            position: fixed;
            top: 50%;
            left: -250px;
            z-index: 50;
            display: flex;
            align-items: center;
            cursor: pointer;
            visibility: hidden;
        }

        .airplane { font-size: 3rem; transform: rotate(10deg); filter: drop-shadow(0 0 10px white); }
        .trail { width: 80px; border-top: 3px dashed rgba(255, 255, 255, 0.4); margin: 0 10px; }
        .final-envelope { font-size: 3.5rem; animation: float 2s infinite ease-in-out; filter: drop-shadow(0 0 15px #ff4d6d); }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        #letter-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 90%;
            max-width: 420px;
            background: #fff;
            padding: 20px;
            border-radius: 20px;
            z-index: 200;
            color: #ff4d6d;
            box-shadow: 0 0 60px rgba(255, 77, 109, 0.6);
            transition: transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-align: center;
            max-height: 90vh;
            overflow-y: auto;
        }

        #letter-modal.open { transform: translate(-50%, -50%) scale(1); }

        .photo-frame {
            width: 100%;
            height: 380px; 
            margin-top: 15px;
            border-radius: 15px;
            overflow: hidden;
            border: 3px solid #fecfef;
            position: relative;
            background-color: #fce7f3;
        }

        .slide-img {
            width: 100%; height: 100%; object-fit: cover;
            position: absolute; top: 0; left: 0; opacity: 0; transition: opacity 1s ease-in-out;
        }
        .slide-img.active { opacity: 1; }

        #overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 150; display: none;
            backdrop-filter: blur(4px);
        }

        #music-btn {
            position: fixed; bottom: 20px; right: 20px; z-index: 1000;
            background: rgba(255, 255, 255, 0.15); width: 50px; height: 50px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(5px);
        }

        @media (max-width: 480px) {
            .timer-box { min-width: 70px; padding: 10px; }
            .timer-val { font-size: 1.8rem; }
            .trail { width: 50px; }
            .final-envelope { font-size: 2.8rem; }
            #timer-message { font-size: 1rem; }
            .photo-frame { height: 320px; }
        }
    </style>
</head>
<body>

    <canvas id="fireworksCanvas"></canvas>

    <div id="stage-init-envelope" class="stage">
        <div class="envelope-btn" onclick="goToNames()">üíå</div>
        <p class="mt-6 text-pink-300 animate-pulse text-lg tracking-widest">‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢</p>
    </div>

    <div id="stage-names" class="stage hidden">
        <h1 class="couple-name">Satu üíó Punch</h1>
        <p class="text-lg text-yellow-200 opacity-90 mt-4 tracking-[0.2em] font-light">HAPPY NEW YEAR 2026</p>
    </div>

    <div id="stage-timer" class="stage hidden">
        <div id="timer-display">
            <div class="timer-box"><span id="days" class="timer-val">0</span><span class="timer-label">‡∏ß‡∏±‡∏ô</span></div>
            <div class="timer-box"><span id="hours" class="timer-val">0</span><span class="timer-label">‡∏ä‡∏°.</span></div>
            <div class="timer-box"><span id="minutes" class="timer-val">0</span><span class="timer-label">‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
            <div class="timer-box"><span id="seconds" class="timer-val">0</span><span class="timer-label">‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span></div>
        </div>
        <div id="timer-message"></div>
    </div>

    <div id="plane-container" onclick="openFinalLetter()">
        <div class="airplane">‚úàÔ∏è</div>
        <div class="trail"></div>
        <div class="final-envelope">üíå</div>
    </div>

    <div id="overlay" onclick="closeFinalLetter()"></div>
    <div id="letter-modal">
        <div id="love-text" class="text-md md:text-lg leading-relaxed font-medium px-4"></div>
        
        <div id="secret-text" class="mt-4 text-pink-400 text-3xl opacity-0 transition-opacity duration-1000">
            üê∑üêΩ
        </div>

        <div class="photo-frame">
            <!-- ‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ï‡∏≤‡∏°‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå image/ ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì -->
            <img src="image/punch1.jpg" class="slide-img active" alt="Punch 1" onerror="this.src='https://images.unsplash.com/photo-1518199266791-5375a83190b7?w=600'">
            <img src="image/punch2.jpg" class="slide-img" alt="Punch 2" onerror="this.style.display='none'">
            <img src="image/punch3.jpg" class="slide-img" alt="Punch 3" onerror="this.style.display='none'">
            <img src="image/punch4.jpg" class="slide-img" alt="Punch 4" onerror="this.style.display='none'">
            <img src="image/punch5.jpg" class="slide-img" alt="Punch 5" onerror="this.style.display='none'">
        </div>

        <p class="text-[9px] text-gray-400 mt-6">‡πÅ‡∏ï‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î</p>
    </div>

    <div id="music-btn" onclick="handleMusic()">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>
    </div>

    <script>
        let audioStarted = false;
        const startDate = new Date('2023-10-24T00:00:00');
        let typeInterval;
        let fireworkCount = 0; 

        const openSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-paper-slide-1530.mp3');
        openSound.volume = 0.5;

        const loveMessage = `‡πÑ‡∏≠‡∏≠‡πâ‡∏ß‡∏ô‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏°‡∏≤<br>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡∏Å‡∏±‡∏ô<br>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏Ñ‡∏≠‡∏¢‡∏î‡∏π‡πÅ‡∏•‡∏Å‡∏±‡∏ô<br>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡πâ<br>‡πÅ‡∏•‡∏∞‡∏≠‡∏∞‡πÑ‡∏£‡∏´‡∏•‡∏≤‡∏¢‡πÜ‡∏≠‡∏¢‡πà‡∏≤‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏°‡∏≤‡∏Å‡∏ô‡∏∞<br>‡∏´‡∏°‡∏î‡∏õ‡∏µ 2025 ‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞ ‡∏à‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏°‡∏õ‡∏µ‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏ô‡∏∞<br><span style="color: #ff4d6d; font-size: 1.4rem; display: block; margin-top: 10px;">‡∏£‡∏±‡∏Å‡∏ô‡∏∞‡∏Ñ‡πà‡∏∞üíñüòò</span>`;

        function typeWriter(el, text, speed = 40, callback = null) {
            el.innerHTML = '';
            let i = 0, charArray = [], isTag = false, currentTag = "";
            for(let char of text) {
                if(char === "<") { isTag = true; currentTag += char; }
                else if(char === ">") { isTag = false; currentTag += char; charArray.push(currentTag); currentTag = ""; }
                else if(isTag) { currentTag += char; }
                else { charArray.push(char); }
            }
            
            if (typeInterval) clearInterval(typeInterval);
            typeInterval = setInterval(() => {
                if (i < charArray.length) { el.innerHTML += charArray[i]; i++; }
                else {
                    clearInterval(typeInterval);
                    if(callback) callback();
                }
            }, speed);
        }

        function goToNames() {
            document.getElementById('stage-init-envelope').classList.add('hidden');
            document.getElementById('stage-names').classList.remove('hidden');
            if(!audioStarted) handleMusic();
            animateFireworks();
            setTimeout(goToTimer, 3500);
        }

        function goToTimer() {
            document.getElementById('stage-names').classList.add('hidden');
            document.getElementById('stage-timer').classList.remove('hidden');
            startCounting();
            const timerMsgEl = document.getElementById('timer-message');
            setTimeout(() => {
                timerMsgEl.style.opacity = 1;
                typeWriter(timerMsgEl, "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏°‡∏≤", 80, () => {
                    setTimeout(() => {
                        timerMsgEl.style.opacity = 0;
                        setTimeout(() => {
                            timerMsgEl.style.opacity = 1;
                            typeWriter(timerMsgEl, "‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏´‡∏¢‡∏∏‡∏î‡∏•‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏ô‡∏µ‡πà‡∏Å‡πá‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ó‡∏≤‡∏á‡∏à‡∏ö‡∏•‡∏á üíó", 60, () => {
                                setTimeout(shrinkTimerAndFlyPlane, 2000);
                            });
                        }, 1000);
                    }, 2000);
                });
            }, 1000);
        }

        function shrinkTimerAndFlyPlane() {
            const timer = document.getElementById('stage-timer');
            const timerDisplay = document.getElementById('timer-display');
            const timerMsgEl = document.getElementById('timer-message');
            timerMsgEl.style.opacity = 0;
            timerDisplay.classList.add('shrunk-timer');
            timer.style.opacity = '0.7'; 
            setTimeout(() => {
                const plane = document.getElementById('plane-container');
                plane.style.visibility = 'visible';
                let pos = -300;
                const target = window.innerWidth / 2 - (window.innerWidth < 480 ? 100 : 140);
                const flyAnim = setInterval(() => {
                    if (pos >= target) { clearInterval(flyAnim); plane.style.left = target + 'px'; }
                    else { pos += 7; plane.style.left = pos + 'px'; }
                }, 20);
            }, 1000);
        }

        function openFinalLetter() {
            openSound.play().catch(e => {});
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('letter-modal').classList.add('open');
            typeWriter(document.getElementById('love-text'), loveMessage, 40, () => {
                setTimeout(() => { document.getElementById('secret-text').style.opacity = 1; }, 500);
            });
            startSlideshow();
        }

        function closeFinalLetter() {
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('letter-modal').classList.remove('open');
            if (window.slideInterval) clearInterval(window.slideInterval);
            if (typeInterval) clearInterval(typeInterval);
        }

        function startCounting() {
            function update() {
                const now = new Date();
                const diff = now - startDate;
                document.getElementById('days').innerText = Math.floor(diff / (1000 * 60 * 60 * 24));
                document.getElementById('hours').innerText = Math.floor((diff / (1000 * 60 * 60)) % 24);
                document.getElementById('minutes').innerText = Math.floor((diff / (1000 * 60)) % 60);
                document.getElementById('seconds').innerText = Math.floor((diff / 1000) % 60);
            }
            if(!window.timerInt) window.timerInt = setInterval(update, 1000);
            update();
        }

        function startSlideshow() {
            const imgs = Array.from(document.querySelectorAll('.slide-img')).filter(img => img.style.display !== 'none');
            if (imgs.length <= 1) return;
            let idx = 0;
            if (window.slideInterval) clearInterval(window.slideInterval);
            window.slideInterval = setInterval(() => {
                imgs[idx].classList.remove('active');
                idx = (idx + 1) % imgs.length;
                imgs[idx].classList.add('active');
            }, 3000);
        }

        // --- Fireworks Animation ---
        const canvas = document.getElementById('fireworksCanvas');
        const ctx = canvas.getContext('2d');
        let fireworks = [], particles = [];
        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.addEventListener('resize', resize); resize();

        class Particle {
            constructor(x, y, hue) {
                this.x = x; this.y = y; this.hue = hue;
                this.angle = Math.random() * Math.PI * 2;
                this.speed = Math.random() * 5 + 1;
                this.alpha = 1; this.decay = Math.random() * 0.01 + 0.015;
            }
            update() { this.x += Math.cos(this.angle) * this.speed; this.y += Math.sin(this.angle) * this.speed + 0.15; this.alpha -= this.decay; }
            draw() { ctx.save(); ctx.globalAlpha = this.alpha; ctx.fillStyle = `hsl(${this.hue}, 100%, 75%)`; ctx.beginPath(); ctx.arc(this.x, this.y, 1.5, 0, Math.PI * 2); ctx.fill(); ctx.restore(); }
        }

        class HeartParticle {
            constructor(x, y, t, hue) {
                this.x = x; this.y = y; this.t = t; this.hue = hue;
                this.alpha = 1; this.decay = 0.015;
            }
            update() {
                this.t += 0.05;
                const scale = 6;
                this.x += scale * 16 * Math.pow(Math.sin(this.t), 3);
                this.y -= scale * (13 * Math.cos(this.t) - 5 * Math.cos(2 * this.t) - 2 * Math.cos(3 * this.t) - Math.cos(4 * this.t));
                this.alpha -= this.decay;
            }
            draw() {
                ctx.save(); ctx.globalAlpha = this.alpha; ctx.fillStyle = `hsl(${this.hue}, 100%, 75%)`;
                ctx.beginPath(); ctx.arc(this.x, this.y, 2, 0, Math.PI * 2); ctx.fill(); ctx.restore();
            }
        }

        class Firework {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = canvas.height;
                this.targetY = Math.random() * (canvas.height * 0.6) + 40;
                this.speed = 5;
                this.hue = Math.random() * 360;
                this.done = false;
                fireworkCount++;
                this.isHeart = fireworkCount % 5 === 0; 
            }
            update() {
                this.y -= this.speed;
                if (this.y <= this.targetY) {
                    this.done = true;
                    if (this.isHeart) {
                        for (let i = 0; i < 40; i++) particles.push(new HeartParticle(this.x, this.y, i * 0.2, this.hue));
                    } else {
                        for (let i = 0; i < 50; i++) particles.push(new Particle(this.x, this.y, this.hue));
                    }
                }
            }
            draw() {
                ctx.fillStyle = `hsl(${this.hue}, 100%, 65%)`;
                ctx.beginPath(); ctx.arc(this.x, this.y, 2, 0, Math.PI * 2); ctx.fill();
            }
        }

        function animateFireworks() {
            ctx.fillStyle = 'rgba(10, 10, 10, 0.2)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            if (Math.random() < 0.05) fireworks.push(new Firework());
            fireworks = fireworks.filter(f => { f.update(); f.draw(); return !f.done; });
            particles = particles.filter(p => { p.update(); p.draw(); return p.alpha > 0; });
            requestAnimationFrame(animateFireworks);
        }

        let audio = null;
        function handleMusic() {
            audioStarted = true;
            if (!audio) { 
                audio = new Audio('https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3'); 
                audio.loop = true; audio.volume = 0.3;
            }
            if (audio.paused) { audio.play().catch(e => {}); document.getElementById('music-btn').style.background = '#ff4d6d'; } 
            else { audio.pause(); document.getElementById('music-btn').style.background = 'rgba(255, 255, 255, 0.15)'; }
        }
    </script>
</body>
</html>